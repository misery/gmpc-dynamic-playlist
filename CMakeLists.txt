CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT(dynamic_playlist C)

FIND_PACKAGE(PkgConfig REQUIRED)
IF(NOT PKG_CONFIG_FOUND)
	MESSAGE(FATAL_ERROR "You need 'pkg-config' to build this plugin!")
ENDIF()


pkg_check_modules(GMPC REQUIRED gmpc>=0.18.1)
pkg_check_modules(DEPS REQUIRED
	libmpd>=0.18
	glib-2.0>=2.16
	gtk+-2.0>=2.8
	gobject-2.0>=2.4
	gmodule-2.0
	gthread-2.0
	)

INCLUDE_DIRECTORIES(${DEPS_INCLUDE_DIRS} ${GMPC_INCLUDE_DIRS})
LINK_DIRECTORIES(${DEPS_LIBRARY_DIRS} ${GMPC_LIBRARY_DIRS})

FILE(GLOB FILES RELATIVE ${PROJECT_SOURCE_DIR} "*.c")
ADD_LIBRARY(dynlist SHARED ${FILES})
SET_TARGET_PROPERTIES(dynlist PROPERTIES OUTPUT_NAME "dynlistplugin")
SET_TARGET_PROPERTIES(dynlist PROPERTIES PREFIX "")
TARGET_LINK_LIBRARIES(dynlist ${DEPS_LIBRARIES} ${GMPC_LIBRARIES})

INSTALL(TARGETS dynlist DESTINATION ${GMPC_LIBDIR}/gmpc/plugins)
SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall")

IF(NOT DEFINED debug OR NOT debug)
	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -D G_DISABLE_ASSERT")
	MESSAGE(STATUS "G_ASSERTs are disabled!")
ELSE()
	MESSAGE(STATUS "G_ASSERTs are enabled!")
ENDIF()
